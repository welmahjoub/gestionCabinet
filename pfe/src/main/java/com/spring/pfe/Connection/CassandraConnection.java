package com.spring.pfe.Connection;
import com.datastax.driver.core.Cluster;
import com.datastax.driver.core.Session;

public class CassandraConnection
{
	static Cluster cluster;
	static Session session;
	static int port=9042;
	static String node="localhost";
	
	/*========================================================================================================================*/
   	/*============================== block static : etablir la connection avec Casandra   =============================*/
   	/*========================================================================================================================*/

	
	static {
		
		cluster = Cluster.builder().addContactPoint(node).withPort(port).build();
		session = cluster.connect();
		
		 System.err.printf(" \n \n Connected to Base de donne Cassandra :\n");
	}


	/*========================================================================================================================*/
   	/*========================================= getConnection  ================================================*/
   	/*========================================================================================================================*/


   public  static Session getSession()
   {
      return session;
   }
 
   /*========================================================================================================================*/
  	/*========================================= close cnx  ================================================*/
  	/*========================================================================================================================*/

   public void close()
   {
      cluster.close();
   }
   

   /*========================================================================================================================*/
  	/*=========================================   ================================================*/
  	/*========================================================================================================================*/

}